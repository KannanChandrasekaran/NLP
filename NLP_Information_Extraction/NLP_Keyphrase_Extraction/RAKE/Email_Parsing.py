# -*- coding: utf-8 -*-
"""
Created on Tue Nov 14 18:03:25 2017

@author: kach
"""

import email
import html2text

htmlstr='''<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><font size="2" face="Tahoma, Verdana, Arial"><span><font style="DISPLAY: inline" size="2" face="Tahoma, Verdana, Arial">Hello Matt,<br><br>Looping in MSTravel.<br><br>Thanks,<br>Mark&nbsp;<br><br><br><img alt="http://hrweb/PublishingImages/HR%20Cube.png" src="http://hrweb/PublishingImages/HR%20Cube.png"><br><span style="COLOR: rgb(0,130,114)"><strong><font size="3" face="Calibri">US HR Operations Support </font></strong></span><font size="3" face="Times New Roman"></font><br><br><span style="FONT-SIZE: 12pt; COLOR: rgb(0,130,114); LINE-HEIGHT: 107%"><font face="Calibri">Find what you need on </font><a href="http://hrweb/"><span style="COLOR: rgb(0,130,114)"><strong><font face="Calibri">HRweb</font></strong></span></a></span><font size="3" face="Times New Roman"> </font><br><br><img alt="http://hrweb/PublishingImages/MS%20logo.jpg" src="http://hrweb/PublishingImages/MS%20logo.jpg"><br></font></span><br>------------------- Original Message -------------------<br><b>From:</b> Matt Shaw<br><b>Received:</b> 9/3/2014 11:19 AM<br><b>To:</b> US HR Operations; US HR Operations Support<br><b>Subject:</b> FW: Products Sync Week Travel...</font><br><br>  <meta name="Generator" content="Microsoft SafeHTML">  <style>  .shape  {;}  </style>    <style>  p.MsoNormal, li.MsoNormal, div.MsoNormal  {margin:0in;margin-bottom:.0001pt;font-size:11.0pt;font-family:"Calibri","sans-serif";}  a:link, span.MsoHyperlink  {color:#0563C1;text-decoration:underline;}  a:visited, span.MsoHyperlinkFollowed  {color:#954F72;text-decoration:underline;}  span.EmailStyle17  {font-family:"Calibri","sans-serif";color:windowtext;}  span.EmailStyle18  {font-family:"Calibri","sans-serif";color:#1F497D;}  span.EmailStyle19  {font-family:"Calibri","sans-serif";color:#1F497D;}  span.EmailStyle20  {font-family:"Calibri","sans-serif";color:#1F497D;}  span.EmailStyle21  {font-family:"Calibri","sans-serif";color:#1F497D;}  span.EmailStyle22  {font-family:"Calibri","sans-serif";color:#1F497D;}  .MsoChpDefault  {font-size:10.0pt;}  @page WordSection1  {size:8.5in 11.0in;margin:1.0in 1.0in 1.0in 1.0in;}  div.WordSection1  {page:WordSection1;}    </style>    <div class="WordSection1">  <p class="MsoNormal"><span style="COLOR: #1f497d">Would you all be able to help me with the background to be able to answer this question?</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">Thanks,</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">Matt</span></p>  <p class="MsoNormal"><a name="_MailEndCompose"><span style="COLOR: #1f497d">&nbsp;</span></a></p>  <div>  <div style="BORDER-TOP: #e1e1e1 1pt solid; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0in; PADDING-TOP: 3pt; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0in; BORDER-LEFT-STYLE: none; PADDING-RIGHT: 0in">  <p class="MsoNormal"><b>From:</b> Matthew Minton <br><b>Sent:</b> Wednesday, September 3, 2014 10:50 AM<br><b>To:</b> Matt Shaw<br><b>Subject:</b> FW: Products Sync Week Travel...</p></div></div>  <p class="MsoNormal">&nbsp;</p>  <p class="MsoNormal"><span style="COLOR: #1f497d">Hey Matt,</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">Graeme Malcolm (new hire on my team) won’t be starting until September 29<sup>th</sup> but I want to have him travel to Redmond during the week of October 6 to participate in the LeX Products sync week. Is it okay for him to book travel outside of our internal travel tools, corporate credit card, etc. for this trip? Is there a better way to do this in light of the travel policy?</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">Thanks for the help!</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="FONT-SIZE: 12pt; COLOR: #5b9bd5">Matthew Minton</span></p>  <p class="MsoNormal"><span style="FONT-SIZE: 10pt; COLOR: #1f497d">Senior Content Publishing Manager</span></p>  <p class="MsoNormal"><span style="FONT-SIZE: 10pt; COLOR: #1f497d">Microsoft Learning Experiences</span></p>  <p class="MsoNormal"><span style="FONT-SIZE: 10pt; COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="FONT-SIZE: 10pt; COLOR: #1f497d">Office: (425) 705-5711</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d"><img id="_x0000_i1025" alt="cid:image002.png@01CFAD72.947CD640" src="/HRSupport/Activities/Attachment/download.aspx?AttachmentType=1001&amp;AttachmentId=d06afefd-9633-e411-9404-002dd802fed8&amp;CRMWRPCToken=FRzZzyi1EeSUEQAt2AL/75mOYn%2bIrX/DVO17SVOHyddZyvZU55iPnlSwFfUkhVSY&amp;CRMWRPCTokenTimeStamp=635453906610038500" width="140" height="30"></span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <div>  <div style="BORDER-TOP: #e1e1e1 1pt solid; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0in; PADDING-TOP: 3pt; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0in; BORDER-LEFT-STYLE: none; PADDING-RIGHT: 0in">  <p class="MsoNormal"><b>From:</b> Darren Day <br><b>Sent:</b> Tuesday, September 2, 2014 4:59 PM<br><b>To:</b> Matthew Minton<br><b>Cc:</b> Sandra Pearce (Robert Half International)<br><b>Subject:</b> RE: Products Sync Week Travel...</p></div></div>  <p class="MsoNormal">&nbsp;</p>  <p class="MsoNormal"><span style="COLOR: #1f497d">Yea, that’s ok.&nbsp; You may get a rule violation, but I don’t know how to get around it.&nbsp; It’s also a policy violation to book travel for someone else.&nbsp; </span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <div>  <div style="BORDER-TOP: #e1e1e1 1pt solid; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0in; PADDING-TOP: 3pt; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0in; BORDER-LEFT-STYLE: none; PADDING-RIGHT: 0in">  <p class="MsoNormal"><b>From:</b> Matthew Minton <br><b>Sent:</b> Tuesday, September 2, 2014 4:45 PM<br><b>To:</b> Darren Day<br><b>Cc:</b> Sandra Pearce (Robert Half International)<br><b>Subject:</b> RE: Products Sync Week Travel...</p></div></div>  <p class="MsoNormal">&nbsp;</p>  <p class="MsoNormal"><span style="COLOR: #1f497d">Great – thanks Darren.</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">Also, Graeme Malcom (new hire) will be starting on Sept 29 and I would like to have him here in Redmond for that week as well. Okay for him to book outside of the internal travel tool?</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">-Matt</span></p>  <p class="MsoNormal"><span style="COLOR: #1f497d">&nbsp;</span></p>  <div>  <div style="BORDER-TOP: #e1e1e1 1pt solid; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0in; PADDING-TOP: 3pt; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0in; BORDER-LEFT-STYLE: none; PADDING-RIGHT: 0in">  <p class="MsoNormal"><b>From:</b> Darren Day <br><b>Sent:</b> Tuesday, September 2, 2014 4:44 PM<br><b>To:</b> Matthew Minton<br><b>Cc:</b> Sandra Pearce (Robert Half International)<br><b>Subject:</b> RE: Products Sync Week Travel...</p></div></div>  <p class="MsoNormal">&nbsp;</p>  <p class="MsoNormal"><span style="COLOR: #1f497d">You have the green light. </span></p>  <div>  <div style="BORDER-TOP: #e1e1e1 1pt solid; BORDER-BOTTOM-STYLE: none; PADDING-BOTTOM: 0in; PADDING-TOP: 3pt; BORDER-RIGHT-STYLE: none; PADDING-LEFT: 0in; BORDER-LEFT-STYLE: none; PADDING-RIGHT: 0in">  <p class="MsoNormal"><b>From:</b> Matthew Minton <br><b>Sent:</b> Tuesday, September 2, 2014 4:24 PM<br><b>To:</b> Darren Day<br><b>Subject:</b> Products Sync Week Travel...</p></div></div>  <p class="MsoNormal">&nbsp;</p>  <p class="MsoNormal">Hey Darren,</p>  <p class="MsoNormal">&nbsp;</p>  <p class="MsoNormal">Do we have the green light to start booking travel for our teams for the Sync Week in October?</p>  <p class="MsoNormal">&nbsp;</p>  <p class="MsoNormal"><span style="FONT-SIZE: 12pt; COLOR: #5b9bd5">Matthew Minton</span></p>  <p class="MsoNormal"><span style="FONT-SIZE: 10pt">Senior Content Publishing Manager</span></p>  <p class="MsoNormal"><span style="FONT-SIZE: 10pt">Microsoft Learning Experiences</span></p>  <p class="MsoNormal"><span style="FONT-SIZE: 10pt">&nbsp;</span></p>  <p class="MsoNormal"><span style="FONT-SIZE: 10pt">Office: (425) 705-5711</span></p>  <p class="MsoNormal">&nbsp;</p>  <p class="MsoNormal"><img id="Picture_x0020_1" alt="cid:image002.png@01CFAD72.947CD640" src="/HRSupport/Activities/Attachment/download.aspx?AttachmentType=1001&amp;AttachmentId=d06afefd-9633-e411-9404-002dd802fed8&amp;CRMWRPCToken=FRzZzyi1EeSUEQAt2AL/75mOYn%2bIrX/DVO17SVOHyddZyvZU55iPnlSwFfUkhVSY&amp;CRMWRPCTokenTimeStamp=635453906610038500" width="140" height="30"></p>  <p class="MsoNormal">&nbsp;</p>  <p class="MsoNormal">&nbsp;</p></div>'''

h=html2text.HTML2Text()
h.ignore_links=True

a=h.handle(htmlstr)


b = email.message_from_string(a)
if b.is_multipart():
    for payload in b.get_payload():
        # if payload.is_multipart(): ...
        print(payload.get_payload())
else:
    print(b.get_payload())


